#This script updates security settings for linux scripts
#This script setup: Password Policy, Lockout Policy, Guest Account, Root Login, Audit Policy and Firewall

#Declare Variables
path="/"
user=$SUDO_USER

#Display Msg
echo "Leninux, Cyber Centurion Security Protocols Updater"

#Check forensic Questions Asked
echo "Are you sure you won't to update security setting, MAKE SURE YOU COMPLETE FORENSIC QUESTIONS FIRST"
read -p "Continue (Y/N): " continuevar

if [ $continuevar="Y" ]
then
	#Execute Script
	#Download Files from GitHub 
	path="/home/"$user"/Desktop/security"
	git clone https://github.com/callumw123/Leninux security

	#copy files over

	#Update Authentication Settings

	cp $path/CommonPassword /etc/pam.d/common-password #Common Password
	cp $path/CommonAuth /etc/pam.d/common-auth #Common Auth
	cp $path/LoginDefs /etc/login.defs #Login Defs

	echo "Security Settings Updated"

	#Disable Guest

	cp $path/Guest /etc/lightdm/lightdm.conf #Guest
	echo "Guest Disabled"

	#Disable Root Login

	passwd -l root	
	
	echo "Root Login Disabled"

	#Enable Firewall

	apt install ufw && apt install gufw
	ufw enable

	#Setup Firewall Settings

	sysctl -n net.ipv4.tcp_syncookies #Enable sys Cookie Protection
	echo net.ipv6.conf.all.disable_ipv6 | sudo tee -a /etc/sysctl.conf #Disable IPv6
	sudo echo 0 | sudo tee -a /proc/sys/net/ipv4/ip_forward #Disable IP Forwarding
	sudo echo "nospoof on" | sudo tee -a /etc/host.conf #Prevent IP Spoofing

	echo "Firewall Enabled"

	#Setup Audit Policy
	apt-get install auditd
	auditctl -e 1
	
	echo "Audit Policy Enabled"


	echo "All Security Settings Updated"
else
	echo "Command Cancelled"
fi 





